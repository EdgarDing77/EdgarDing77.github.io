# 问题记录

2022/4/2

> "No mapping found for [timestamp] in order to sort on”

解决参考：https://blog.csdn.net/lzxlfly/article/details/114199240



2022/3/25

> warning: usage of JAVA_HOME is deprecated, use ES_JAVA_HOME
>
> 错误: 找不到或无法加载主类 org.elasticsearch.tools.java_version_checker.JavaVersionChecker

1. elasticsearch用户下执行`java --version`检查java版本正常
2. 检查elasticsearch7文件夹目录，发现weadmin工作目录全部在在root目录下，移动weadmin整个工作目录到其它目录，这样elasticsearch7文件夹目录也不在/root目录下了，重启elasticsearch正常。

> ERROR: [1] bootstrap checks failed. You must address the points described in the following [1] lines before starting Elasticsearch.
>
> bootstrap check failure [1] of [1]: max file descriptors [4096] for elasticsearch process is too low, increase to at least [65535]

解决方案：



2022/3/24

> Elasticsearch exception [type=illegal_argument_exception, reason=request [/sys-log-*/_search] contains unrecognized parameters: [ccs_minimize_roundtrips], [ignore_throttled]]

原因：ES版本与SpringBoot的版本不兼容。

解决：更换ES版本或者更换SpringBoot版本。



2022/2/8

ELK中logstash就是shutdown，原因还没找出

错误日志：

```bash
[main] Pipeline error {:pipeline_id=>"main", :exception=>#<Grok::PatternError: pattern %{NGINXACCESS} not defined>, :backtrace=>["/opt/logstash/vendor/bundle/jruby/2.5.0/gems/jls-grok-0.11.5/lib/grok-pure.rb:123:in `block in compile'", "org/jruby/RubyKernel.java:1442:in `loop'", "/opt/logstash/vendor/bundle/jruby/2.5.0/gems/jls-grok-0.11.5/lib/grok-pure.rb:93:in `compile'", "/opt/logstash/vendor/bundle/jruby/2.5.0/gems/logstash-filter-grok-4.4.1/lib/logstash/filters/grok.rb:282:in `block in register'", "org/jruby/RubyArray.java:1821:in `each'", "/opt/logstash/vendor/bundle/jruby/2.5.0/gems/logstash-filter-grok-4.4.1/lib/logstash/filters/grok.rb:276:in `block in register'", "org/jruby/RubyHash.java:1415:in `each'", "/opt/logstash/vendor/bundle/jruby/2.5.0/gems/logstash-filter-grok-4.4.1/lib/logstash/filters/grok.rb:271:in `register'", "org/logstash/config/ir/compiler/AbstractFilterDelegatorExt.java:75:in `register'", "/opt/logstash/logstash-core/lib/logstash/java_pipeline.rb:232:in `block in register_plugins'", "org/jruby/RubyArray.java:1821:in `each'", "/opt/logstash/logstash-core/lib/logstash/java_pipeline.rb:231:in `register_plugins'", "/opt/logstash/logstash-core/lib/logstash/java_pipeline.rb:590:in `maybe_setup_out_plugins'", "/opt/logstash/logstash-core/lib/logstash/java_pipeline.rb:244:in `start_workers'", "/opt/logstash/logstash-core/lib/logstash/java_pipeline.rb:189:in `run'", "/opt/logstash/logstash-core/lib/logstash/java_pipeline.rb:141:in `block in start'"], "pipeline.sources"=>["/etc/logstash/conf.d/02-beats-input.conf", "/etc/logstash/conf.d/10-syslog.conf", "/etc/logstash/conf.d/11-nginx.conf", "/etc/logstash/conf.d/30-output.conf"], :thread=>"#<Thread:0x70b54f3e run>"}
```

需要学习logstash配置语法，初步鉴定是配置与最新的版本不符。





2022/1/20

*真是被自己愚蠢到了，前端调试还一直cosole.log()，居然不知道Chrome的debug！！！！！！！*



2022/1/17

传入path值时尽量都用String，这样传入空值的时候，不会导致服务500的报错。

前端路由



2022/1/11

- 多级菜单的循环构建，时间复杂度O(n^m)m为联动级数

- ```
  // 统一header注入
  admin.getAjaxHeaders = function (requestUrl) {
      var headers = [];
      let token = djjConfig.getToken();
      headers.push({name: 'Authorization', value: 'Bearer ' + token.access_token});
      return headers;
  }
  ```



2022/1/9

- 前端｜admin.req：统一Headers填充，每次手动填写麻烦，未找到实现方式。(1/11完成)

  - 采用MVVM框架，注意引入顺序！！！！！！

  - 若发生404，可以删除target文件

  - ```html
    <!-- js部分 -->
    <script type="text/javascript" src="assets/libs/jquery/jquery-3.2.1.min.js"></script>
    <script type="text/javascript" src="assets/libs/pandyle.min.js"></script>
    ```



2022/1/5

- 后端模块使用



2022/1/3

- 用户状态更新后，用户仍然可以继续使用



2021/12/26

- 前端目录side和head需要js异步请求，根据权限从数据库中返回相应目录
  - 在开发的时候，可以先不用如此，方便数据的构造
- knife4j 文档生成与配置



2021/12/23

- 前端JS不运行，idea内置能运行，spring boot启动后访问无法加载，但没有报错

2021/12/18

- ODIC实现（Open Id）
- Mobile登录方式
- 同一应用账号互踢操作
- Spring Security + OAuth2 授权模式实现 自定义方式



2021/12/12

- RedisTokenStore实现（针对Token自动续签进行定制）

- URL级权限问题

  

2021/12/11

- AuthJwt和ResJwt的设计与实现（即非对称加密Jwt的使用）

- 如何通过访问授权服务器获取非对称加密公钥 Key？具体实现？
  - 这里获取JWT公钥的URL方式：`http://127.0.0.1:9900/api-uaa/tokens/key`



2021/12/6

- 登录认证系统
- OAuth2配置与实现 与 Spring Security结合
- UAA授权中心

2021/12/4

- MyBatis plus多租户与分页的配置
  - 如何实现语句的隔离？
    - 通过使用拦截忽略注解 @InterceptorIgnore

2021/12/2

- 分布式ID生成器解决方案
- MDC值在父子线程传递的问题（分布式日志链路追踪）
  - 主要针对业务会使用线程池(异步、并行处理)，并且`spring`自己也有`@Async`注解来使用线程池，要解决这个问题需要以下两个步骤。具体参考文章[分布式日志链路追踪]()。
  - `TtlMDCAdapter`代替`LogbackMDCAdapter`，需要进行重写。

- 分布式锁的实现

2021/12/1

- 有关可以重写的，公共全局配置，可以在已有的框架上重写一层父类，减少耦合

  

